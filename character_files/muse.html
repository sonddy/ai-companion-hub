<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Muse - Creative AI</title>
  <style>
    :root {
      --bg: #150a0f;
      --card: #1f1015;
      --accent: #ff6699;
      --accent-2: #ff9966;
      --text: #ffe8f0;
      --muted: #c090a0;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Palatino', serif;
      background: linear-gradient(135deg, #150a0f 0%, #1f1015 50%, #251520 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }
    .paint-splatter {
      position: fixed;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.3;
      pointer-events: none;
      z-index: 0;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    .header {
      text-align: center;
      padding: 40px 0;
      border-bottom: 2px solid rgba(255, 102, 153, 0.3);
      margin-bottom: 30px;
    }
    .header h1 {
      font-size: 56px;
      background: linear-gradient(135deg, #ff6699, #ff9966, #ffcc66);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }
    .header p { color: var(--muted); font-style: italic; }
    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background: rgba(255, 102, 153, 0.2);
      border: 1px solid var(--accent);
      color: var(--accent);
      border-radius: 8px;
      text-decoration: none;
      font-size: 14px;
      z-index: 10;
    }
    .back-btn:hover { background: rgba(255, 102, 153, 0.3); }
    .chat-box {
      background: rgba(31, 16, 21, 0.95);
      border: 2px solid rgba(255, 102, 153, 0.3);
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 0 40px rgba(255, 102, 153, 0.15);
    }
    .messages {
      height: 400px;
      overflow-y: auto;
      padding: 15px;
      margin-bottom: 15px;
      border: 1px solid rgba(255, 102, 153, 0.2);
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.3);
    }
    .message {
      padding: 15px 20px;
      border-radius: 15px;
      margin-bottom: 15px;
      max-width: 85%;
    }
    .message.user {
      background: linear-gradient(135deg, #2a1a20, #3d2030);
      margin-left: auto;
      border: 1px solid rgba(255, 153, 102, 0.2);
    }
    .message.muse {
      background: linear-gradient(135deg, #3d1a30, #ff669930);
      border: 1px solid rgba(255, 102, 153, 0.3);
    }
    .message-label {
      font-size: 11px;
      color: var(--accent);
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    .input-area {
      display: flex;
      gap: 10px;
    }
    .input-area input {
      flex: 1;
      padding: 15px 20px;
      border-radius: 25px;
      border: 1px solid rgba(255, 102, 153, 0.3);
      background: rgba(0, 0, 0, 0.5);
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
    }
    .input-area input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 20px rgba(255, 102, 153, 0.3);
    }
    button {
      padding: 15px 30px;
      border-radius: 25px;
      border: none;
      background: linear-gradient(135deg, #ff6699, #ff9966);
      color: white;
      font-weight: bold;
      cursor: pointer;
      font-family: inherit;
    }
    button:hover { opacity: 0.9; }
    .mic-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 20px;
      padding: 0;
    }
    .mic-btn.recording {
      background: linear-gradient(135deg, #ff3366, #ff6699);
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    .status {
      text-align: center;
      color: var(--accent);
      font-size: 12px;
      margin-top: 15px;
      font-style: italic;
    }
    .topics-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .topic-btn {
      padding: 15px;
      text-align: center;
      background: rgba(255, 102, 153, 0.15);
      border: 1px solid rgba(255, 102, 153, 0.3);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      color: var(--text);
    }
    .topic-btn:hover {
      background: rgba(255, 102, 153, 0.3);
      transform: translateY(-3px);
    }
    .topic-btn .icon {
      font-size: 28px;
      margin-bottom: 8px;
    }
    .topic-btn .label {
      font-size: 12px;
      color: var(--muted);
    }
    audio { display: none; }
  </style>
</head>
<body>
  <!-- Paint splatters for artistic effect -->
  <div class="paint-splatter" style="width: 300px; height: 300px; background: #ff6699; top: 10%; left: 5%;"></div>
  <div class="paint-splatter" style="width: 200px; height: 200px; background: #ff9966; top: 60%; right: 10%;"></div>
  <div class="paint-splatter" style="width: 250px; height: 250px; background: #ffcc66; bottom: 10%; left: 30%;"></div>
  
  <a href="main.html" class="back-btn">‚Üê Back to Hub</a>
  
  <div class="container">
    <div class="header">
      <h1>üé® MUSE</h1>
      <p>Creative AI ‚Ä¢ Art History ‚Ä¢ Music Theory ‚Ä¢ Artistic Inspiration</p>
    </div>
    
    <div class="chat-box">
      <div class="messages" id="messages">
        <div class="message muse">
          <div class="message-label">Muse</div>
          <div class="message-text">Greetings, fellow creative soul! I am Muse, your guide through the magnificent world of arts and music. From the Renaissance masters to contemporary beats, from symphonies to street art - let's explore the beauty of human expression together. What artistic journey shall we embark upon?</div>
        </div>
      </div>
      
      <div class="input-area">
        <input type="text" id="userInput" placeholder="Ask about art, music, or creativity..." autofocus />
        <button id="micBtn" class="mic-btn" title="Click to speak">üé§</button>
        <button id="sendBtn">Inspire</button>
      </div>
      <div class="status" id="status">üéµ Ready to create and inspire üé®</div>
    </div>
    
    <div class="topics-grid">
      <div class="topic-btn" onclick="askTopic('Tell me about the Renaissance art movement')">
        <div class="icon">üñºÔ∏è</div>
        <div class="label">Renaissance</div>
      </div>
      <div class="topic-btn" onclick="askTopic('Explain music theory basics')">
        <div class="icon">üéº</div>
        <div class="label">Music Theory</div>
      </div>
      <div class="topic-btn" onclick="askTopic('Who was Van Gogh and what made his art special?')">
        <div class="icon">üåª</div>
        <div class="label">Van Gogh</div>
      </div>
      <div class="topic-btn" onclick="askTopic('Tell me about jazz music history')">
        <div class="icon">üé∑</div>
        <div class="label">Jazz</div>
      </div>
      <div class="topic-btn" onclick="askTopic('What is impressionism in art?')">
        <div class="icon">üé®</div>
        <div class="label">Impressionism</div>
      </div>
      <div class="topic-btn" onclick="askTopic('Tell me about Beethoven')">
        <div class="icon">üéπ</div>
        <div class="label">Beethoven</div>
      </div>
      <div class="topic-btn" onclick="askTopic('What is abstract art?')">
        <div class="icon">üî∑</div>
        <div class="label">Abstract Art</div>
      </div>
      <div class="topic-btn" onclick="askTopic('Give me creative inspiration for today')">
        <div class="icon">‚ú®</div>
        <div class="label">Inspiration</div>
      </div>
    </div>
  </div>
  
  <audio id="player"></audio>
  
  <script>
    const CHAT_ENDPOINT = 'http://127.0.0.1:8009/chat';
    
    const messages = document.getElementById('messages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const micBtn = document.getElementById('micBtn');
    const statusEl = document.getElementById('status');
    const player = document.getElementById('player');
    
    function addMessage(text, sender) {
      const div = document.createElement('div');
      div.className = `message ${sender}`;
      div.innerHTML = `<div class="message-label">${sender === 'user' ? 'You' : 'Muse'}</div><div class="message-text">${text}</div>`;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }
    
    function setStatus(msg) { statusEl.textContent = msg; }
    
    async function sendMessage(text) {
      const msgText = text || userInput.value.trim();
      if (!msgText) return;
      
      addMessage(msgText, 'user');
      userInput.value = '';
      sendBtn.disabled = true;
      setStatus('üé≠ Channeling creativity...');
      
      try {
        const res = await fetch(CHAT_ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: msgText })
        });
        
        if (!res.ok) throw new Error(`Error: ${res.status}`);
        
        const rawResponse = res.headers.get('X-Muse-Response') || '...';
        addMessage(decodeURIComponent(rawResponse), 'muse');
        
        const blob = await res.blob();
        player.src = URL.createObjectURL(blob);
        player.play();
        setStatus('üé∂ Muse speaks...');
        
      } catch (err) {
        addMessage("The creative connection is interrupted. Please ensure the Muse server is running on port 8009.", 'muse');
        setStatus('Connection error');
      } finally {
        sendBtn.disabled = false;
      }
    }
    
    function askTopic(topic) {
      userInput.value = topic;
      sendMessage();
    }
    
    player.addEventListener('ended', () => setStatus('üéµ Ready to create and inspire üé®'));
    sendBtn.addEventListener('click', () => sendMessage());
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
    
    // Voice input
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = true;
      recognition.lang = 'en-US';
      
      let isRecording = false;
      
      recognition.onstart = () => {
        isRecording = true;
        micBtn.classList.add('recording');
        setStatus('üéß Listening to your creative thoughts...');
      };
      
      recognition.onresult = (event) => {
        let transcript = '';
        for (let i = event.resultIndex; i < event.results.length; i++) {
          transcript += event.results[i][0].transcript;
        }
        userInput.value = transcript;
        if (event.results[event.results.length - 1].isFinal) {
          setTimeout(() => { if (userInput.value.trim()) sendMessage(); }, 500);
        }
      };
      
      recognition.onend = () => {
        isRecording = false;
        micBtn.classList.remove('recording');
        setStatus('üéµ Ready to create and inspire üé®');
      };
      
      recognition.onerror = () => {
        isRecording = false;
        micBtn.classList.remove('recording');
      };
      
      micBtn.addEventListener('click', () => {
        if (isRecording) recognition.stop();
        else recognition.start();
      });
    }
  </script>
</body>
</html>


